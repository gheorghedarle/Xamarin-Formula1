<?xml version="1.0" encoding="UTF-8"?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms" 
      xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
      xmlns:xct="http://xamarin.com/schemas/2020/toolkit"
      xmlns:fragments="clr-namespace:Formula1.Views.Fragments"
      x:Class="Formula1.Views.TabViews.HomeView"
      BindingContext="{Binding HomeView, Source={StaticResource ViewModelLocator}}"
      NavigationPage.HasNavigationBar="False">
    <StackLayout
        BackgroundColor="{AppThemeBinding Light={StaticResource LightPageBackgroundColor}, Dark={StaticResource DarkPageBackgroundColor}}">
        <Grid
            ColumnDefinitions="*, Auto"
            RowDefinitions="Auto, Auto"
            RowSpacing="0"
            Margin="20, 10, 20, 5">
            <Label
                Grid.Column="0"
                Grid.Row="0"
                Style="{StaticResource Body1FontSize_ExoRegular}"
                Text="Hello"
                TextColor="{AppThemeBinding Light={StaticResource LightSecondaryTextColor}, Dark={StaticResource DarkSecondaryTextColor}}"></Label>
            <Label
                Grid.Column="0"
                Grid.Row="1"
                Style="{StaticResource Body1FontSize_ExoBold}"
                Text="Formula 1 Fan"
                TextColor="{AppThemeBinding Light={StaticResource LightPrimaryTextColor}, Dark={StaticResource DarkPrimaryTextColor}}"></Label>
            <Label
                Grid.Column="1"
                Grid.Row="0"
                Grid.RowSpan="2"
                Text="&#xf2bd;"
                TextColor="{StaticResource AccentColor}"
                FontSize="{StaticResource Headline2FontSize}"
                FontFamily="FontAwesome_Solid"
                VerticalOptions="Center"
                HorizontalOptions="Center"
                Margin="5, 0, 5, 0">
                <Label.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding ProfileCommand}"></TapGestureRecognizer>
                </Label.GestureRecognizers>
            </Label>
        </Grid>
        <Label
            Text="Latest results"
            Style="{StaticResource Body1FontSize_ExoBold}"
            Margin="20, 0, 20, 0"></Label>
        <Label
            Text="{Binding LatestRace}"
            Style="{StaticResource Body2FontSize_ExoRegular}"
            Margin="20, 0, 20, 0"></Label>
        <StackLayout
            xct:StateLayout.CurrentState="{Binding ResultsState}"
            HeightRequest="120"
            Margin="20, 0, 20, 5">
            <xct:StateLayout.StateViews>
                <xct:StateView 
                    StateKey="Loading"
                    VerticalOptions="FillAndExpand">
                    <fragments:LoadingView></fragments:LoadingView>
                </xct:StateView>
                <xct:StateView 
                    StateKey="Error"
                    VerticalOptions="FillAndExpand">
                    <Label Text="Error"></Label>
                </xct:StateView>
                <xct:StateView 
                    StateKey="Empty"
                    VerticalOptions="FillAndExpand">
                    <Label Text="Empty"></Label>
                </xct:StateView>
            </xct:StateLayout.StateViews>
            <CollectionView
                ItemsSource="{Binding LatestResults}">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout
                        Orientation="Horizontal"
                        ItemSpacing="10"></LinearItemsLayout>
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <StackLayout
                            Padding="0, 0, 0, 5">
                            <Frame
                                BackgroundColor="{AppThemeBinding Light={StaticResource LightCardBackgroundColor}, Dark={StaticResource DarkCardBackgroundColor}}"
                                CornerRadius="20"
                                Padding="0">
                                <Grid
                                    RowDefinitions="Auto, Auto, Auto, Auto"
                                    ColumnDefinitions="Auto, Auto"
                                    RowSpacing="0"
                                    Margin="5, 0, 5, 0">
                                    <Label
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Text="{Binding Position}"
                                        Style="{StaticResource Headline2_ExoBold}"
                                        TextColor="{StaticResource AccentColor}"
                                        Margin="10, 0, 0, 0"></Label>
                                    <Label
                                        Grid.Row="1"
                                        Grid.Column="0"
                                        Text="{Binding Driver.GivenName}"
                                        Style="{StaticResource Body1FontSize_ExoRegular}"
                                        Margin="10, 0, 0, 0">
                                    </Label>
                                    <Label
                                        Grid.Row="2"
                                        Grid.Column="0"
                                        Text="{Binding Driver.FamilyName}"
                                        Style="{StaticResource Body1FontSize_ExoBold}"
                                        Margin="10, 0, 0, 0">
                                    </Label>
                                    <Label
                                        Grid.Row="3"
                                        Grid.Column="0"
                                        Text="{Binding Constructor.Name}"
                                        Style="{StaticResource CaptionFontSize_ExoRegular}"
                                        Margin="10, 0, 0, 5">
                                    </Label>
                                    <Image
                                        Grid.Row="0"
                                        Grid.RowSpan="4"
                                        Grid.Column="1"
                                        Source="{Binding Driver.Image}"
                                        WidthRequest="100"
                                        HeightRequest="100"
                                        Aspect="AspectFill"
                                        HorizontalOptions="End"
                                        VerticalOptions="End"
                                        Margin="10, 0, 0, -11">
                                    </Image>
                                </Grid>
                            </Frame>
                        </StackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </StackLayout>
        <Label
            Text="Next races"
            Style="{StaticResource Body1FontSize_ExoBold}"
            Margin="20, 0, 20, 0"></Label>
        <StackLayout
            xct:StateLayout.CurrentState="{Binding ScheduleState}"
            HeightRequest="80"
            Margin="20, 0, 20, 5">
            <xct:StateLayout.StateViews>
                <xct:StateView 
                    StateKey="Loading"
                    VerticalOptions="FillAndExpand">
                    <fragments:LoadingView></fragments:LoadingView>
                </xct:StateView>
                <xct:StateView 
                    StateKey="Error"
                    VerticalOptions="FillAndExpand">
                    <Label Text="Error"></Label>
                </xct:StateView>
                <xct:StateView 
                    StateKey="Empty"
                    VerticalOptions="FillAndExpand">
                    <Label Text="Empty"></Label>
                </xct:StateView>
            </xct:StateLayout.StateViews>
            <CollectionView
                ItemsSource="{Binding UpcomingRaceEventList}">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout
                        Orientation="Horizontal"
                        ItemSpacing="10"></LinearItemsLayout>
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <StackLayout
                            Margin="5, 10, 5, 10"
                            Padding="0, 0, 0, 5">
                            <Frame
                                BackgroundColor="{AppThemeBinding Light={StaticResource LightCardBackgroundColor}, Dark={StaticResource DarkCardBackgroundColor}}"
                                CornerRadius="20"
                                Padding="5, 10">
                                <Grid
                                    RowDefinitions="Auto, Auto, Auto"
                                    ColumnDefinitions="Auto, Auto"
                                    RowSpacing="0"
                                    Margin="5, 0, 5, 0"
                                    VerticalOptions="Center">
                                    <Image
                                        Grid.Row="0"
                                        Grid.RowSpan="3"
                                        Grid.Column="0"
                                        Source="{Binding Circuit.Location.Flag}"
                                        WidthRequest="40"
                                        HeightRequest="40"
                                        Margin="10, 0, 10, 0"
                                        Aspect="AspectFill"
                                        HorizontalOptions="Center"
                                        VerticalOptions="Center">
                                        <Image.Clip>
                                            <EllipseGeometry
                                                Center="20,20"
                                                RadiusX="20"
                                                RadiusY="20"/>
                                        </Image.Clip>
                                    </Image>
                                    <Label
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Text="{Binding Round, StringFormat='Round {0}'}"
                                        Style="{StaticResource CaptionFontSize_ExoRegular}"
                                        TextColor="{StaticResource AccentColor}"></Label>
                                    <Label
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Text="{Binding Circuit.Location.Country}"
                                        Style="{StaticResource Body1FontSize_ExoBold}">
                                    </Label>
                                    <Label
                                        Grid.Row="2"
                                        Grid.Column="1"
                                        Style="{StaticResource CaptionFontSize_ExoRegular}">
                                        <Label.Text>
                                            <MultiBinding StringFormat="{}{0:d MMM} - {1:d MMM yyyy}">
                                                <Binding Path="FirstPractice.Date" />
                                                <Binding Path="Date" />
                                            </MultiBinding>
                                        </Label.Text>
                                    </Label>
                                </Grid>
                            </Frame>
                        </StackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </StackLayout>
        <Label
            Text="Stadings"
            Style="{StaticResource Body1FontSize_ExoBold}"
            Margin="20, 0, 20, 0"></Label>
    </StackLayout>
</ContentPage>